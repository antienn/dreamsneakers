<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Sneakers</title>
    <link rel="SHORTCUT ICON" href= "./data/img/logo.png" type="image/x-icon" />
    <link rel="stylesheet" href="https://quythanh.tk/assets/css/fontawesomepro/all.css">
    <link rel="stylesheet" href="./css/home.css">
    <link rel="stylesheet" href="./css/shoe.css">
    <link rel="stylesheet" href="./css/intro.css">
    <link rel="stylesheet" href="./css/modal.css">
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"
    />

    <!-- META FOR FACEBOOK -->
    <meta property="og:image" itemprop="thumbnailUrl" content="https://i.imgur.com/wSU9Arq.png"/>
    <meta property="og:image:width" content="1000"/>
    <meta property="og:image:height" content="500"/>
    <meta content="hệ thống bán giày lớn nhất thế giới" itemprop="headline" property="og:title"/>

</head>
<body id="body">
    <div class="modal hide">
        <div class="modal__inner">
            <div class="modal__header">
                <div class="modal__title">Edit profile</div>
                <i class="fas fa-times"></i>
            </div>
            <div class="modal__body">
                <div>
                    <label for="fname">First name:</label>
                    <input type="text" id="fname" name="fname" value="">
                </div>
                <div>
                    <label for="lname">Last name:</label>
                    <input type="text" id="lname" name="lname" value="">
                </div>
            </div>
            <div class="modal__footer">
                <button class="modal__button-apply">Apply</button>
            </div>
        </div>
    </div>

    <div class="blackPage">
    </div>
    <div class="app">
        <div class="header">
            <ol>
                <li>
                    <img src="./data/img/shoe.png" height="50px" >
                </li>
                <li>
                    <ol>
                        <div class="option" id="home">Home</div>
                        <div class="option" id="brand">
                            Brand
                            <ul class="brand__subnav">
                                <li class="subnav__item" id="Nike">Nike</li>
                                <li class="subnav__item" id="Adidas">Adidas</li>
                                <li class="subnav__item" id="Fila">Fila</li>
                                <li class="subnav__item" id="Puma">Puma</li>
                                <li class="subnav__item" id="New Balance">New Balance</li>
                                <li class="subnav__item" id="Under Armour">Under Armour</li>
                                <li class="subnav__item" id="Balenciaga">Balenciaga</li>
                                <li class="subnav__item" id="Burberry">Burberry</li>
                            </ul>
                        </div>
                        <div class="option" id="welcomename"></div>
                    </ol>
                </li>
                <li>

                </li>
                <li>
                    <div class="header-right-user">
                        <i class="fa-solid fa-user-large"></i>
                        <ul class="profile__subnav">
                            <li class="profile__item editprofile">
                                <i class="fa-solid fa-pen-to-square"></i>
                                Edit profile
                            </li>
                            <li class="profile__item logout">
                                <i class="fa-solid fa-right-from-bracket"></i>
                                Log out
                            </li>
                        </ul>
                    </div>
                    <div class="login">login</div>
                </li>
            </ol>
        </div>
    </div>

    <div class="swiper mySwiper">
        <div class="swiper-wrapper">
          <div class="swiper-slide">
            <img src="./data/img/banner1final.jpg" />
          </div>
          <div class="swiper-slide">
            <img src="https://swiperjs.com/demos/images/nature-2.jpg" />
          </div>
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-pagination"></div>
    </div>
    
    <div class="content">
        <p>best seller</p>
        <div class="content__bestSeller" id="scrollhere"></div> 
    </div>
    <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
    <script src="./data/infor/data.js"></script> 
    <script src="./js/showshoe.js"></script>  
    <script src="./js/toast.js"></script>  
    <script>
        const returnHome = document.getElementById("home");
        const users = JSON.parse(localStorage.getItem("users"))
        const returnLogin = document.querySelector('.login');
        const listShoeShow = document.querySelector('.content__bestSeller');
        const userImg = document.querySelector(".header-right-user");
        const profile = document.querySelector(".profile__subnav");
        const blockScroll = document.getElementById("body");
        const blackPage = document.querySelector(".blackPage");
        const titleBrand =document.getElementById("brand");
        const brand = document.querySelector(".brand__subnav");
        var setName = document.getElementById("welcomename");
        const curUserr = JSON.parse(localStorage.getItem('curUser'));
        if(curUserr){
            document.getElementById("welcomename").innerHTML = "Hi, " + curUserr.lastName;
            returnLogin.style.display = "none";
            localStorage.removeItem("curUser");
        }else{
            userImg.style.display = "none"; 
        } 
        titleBrand.onclick = () => {
            if(!titleBrand.classList.contains("active")){
                brand.classList.add("active")
                titleBrand.classList.add("active")
                blackPage.classList.add("active")
                blockScroll.classList.add("active")
                profile.classList.remove("active")
                userImg.classList.remove("active")
                blackPage.style.transformOrigin ="top"
            }else{
                brand.classList.remove("active")
                titleBrand.classList.remove("active")
                blackPage.classList.remove("active")
                blockScroll.classList.remove("active")
            }
        }
        blackPage.onclick = () => {
            if(blackPage.classList.contains("active")){
                profile.classList.remove("active")
                brand.classList.remove("active")
                titleBrand.classList.remove("active")
                blackPage.classList.remove("active")
                blockScroll.classList.remove("active")
                userImg.classList.remove("active")
            }
        }
        userImg.onclick = () => {
            if(!profile.classList.contains("active")){
                userImg.classList.add("active")
                profile.classList.add("active")
                blackPage.classList.add("active")
                blockScroll.classList.add("active")
                brand.classList.remove("active")
                titleBrand.classList.remove("active")
                blackPage.style.transformOrigin ="top right"
            }else{
                profile.classList.remove("active")
                blackPage.classList.remove("active")
                blockScroll.classList.remove("active")
                userImg.classList.remove("active")
                
            }
        }
        //logout
        profile.onclick = function (e){
            if(e.target.closest(".logout")){
                window.location.href="./login.html";
            }
            //edit profile
            if(e.target.closest(".editprofile")){
                toggleModal();
            }
        }

        //edit profile
        const toggleModal = () => {
            document.querySelector('.modal').classList.toggle('hide');
        }

        document.querySelector('.fas.fa-times').addEventListener('click', () => toggleModal())
        document.querySelector('.modal').addEventListener('click', e => e.target == e.currentTarget ? toggleModal() : e.preventDefault())
        if(curUserr){
            document.querySelector('#fname').value = curUserr.firstName;
            document.querySelector('#lname').value = curUserr.lastName;
        }
        // save
        document.querySelector('.modal__button-apply').onclick = () =>{
            curUserr.firstName = document.querySelector('#fname').value.trim();
            curUserr.lastName = document.querySelector('#lname').value.trim();
            if(curUserr){
                document.getElementById("welcomename").innerHTML = "Hi, " + curUserr.lastName;
                toggleModal();
                for(let i = 0 ; i < users.length;i++){
                    if(curUserr.mail == users[i].mail){
                        users[i].firstName = document.querySelector('#fname').value.trim();
                        users[i].lastName = document.querySelector('#lname').value.trim();
                    }
                }
                localStorage.setItem("users", JSON.stringify(users));
            }
        }


        // swiper library
        var swiper = new Swiper(".mySwiper", {
            spaceBetween: 30,
            effect: "fade",
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
        });
        //sort shoe
        
        var sortShoe = document.querySelectorAll('.subnav__item');
        for (let i = 0; i < sortShoe.length; i++) {
            sortShoe[i].onclick = function (e){
                var nameBrand = e.target.id;
                listShoeShow.innerHTML='';
                showShoe(0,sortBrand(listShoe,nameBrand),document.querySelector('.content__bestSeller'));
                window.location= "#scrollhere";
                returnHome.style.borderBottom ="none";
            }
        }
        returnLogin.onclick= () =>{
            window.location.href="./login.html";
        }

        //returnhome
        returnHome.onclick =() =>{
            listShoeShow.innerHTML='';
            showShoe(0,listShoe,document.querySelector('.content__bestSeller'));
            returnHome.style.borderBottom =" 3px solid #333";
            window.location= "#scrollhere";
        }

        
    </script>
</body>

</html>
